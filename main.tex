% Nejprve uvedeme tridu dokumentu s volbami
\documentclass[czech,bachelor,public,dept460,male,oneside]{diploma}
\usepackage{subfig}		% makra pro "podobrazky" a "podtabulky"
\usepackage{amssymb}
\usepackage{pifont}
\usepackage{hyperref}

\newcommand{\xmark}{\ding{55}}
\newcommand{\cmark}{\ding{51}}

\newcommand{\addfig}[3]{
	\begin{figure}[!h]
		\centering
		\includegraphics[width=#2\textwidth]{Figures/#1}
		\caption{#3}
	\end{figure}
}

\ThesisAuthor{Radek Svoboda}

\CzechThesisTitle{Nástroj pro modelování relační databáze}

\EnglishThesisTitle{Relational Database Modeling Tool}

\SubmissionDate{28. dubna 2017}

\Thanks{Rád bych na tomto místě poděkoval vedoucímu mé bakalářské práce Ing. Petru Lukášovi za poskytnuté rady a čas strávený konzultacemi.}

\ThesisAssignmentImagePath{Figures/Assignment}

% Zadame soubor s digitalizovanou podobou prohlaseni autora zaverecne prace.
% Pokud toto makro zapoznamkujeme sazi se cisty text prohlaseni.

%\AuthorDeclarationImageFile{Figures/AuthorDeclaration.jpg}


\CzechAbstract{Tato bakalářská práce se zabývá návrhem a implementací softwarového nástroje pro návrh schématu relační databáze formou ER diagramu. Nástroj umožní uživateli nejen tvorbu nových schémat databáze, ale také vizualizaci již existujících schémat a jejich následné modifikace prostřednictvím změn ER diagramu v grafickém editoru. V první části se práce zabývá notací ER diagramu a srovnáním již existujících nástrojů určených k tvorbě ER diagramů. Druhá část se zaměřuje na návrh a implementaci jak grafického editoru, tak na problematiku synchronizace ER diagramu s existujícím relačním schématem.}

\CzechKeywords{relační databáze, ER diagram, relační schéma, CASE nástroj}

\EnglishAbstract{This thesis describes design and implementation of software tool for relational database schema design in form of an ER diagram. Tool is not limited only for creation of new database schemas, but it also provides visualization of already existing schemas and their subsequent modifications through changing ER diagram in graphic editor. The first part deals with ER diagram notation and the comparison of existing tools for the creation of ER diagrams. The second part focuses on the design and implementation of both the graphical editor, and on the synchronization of ER diagram with existing relational schema.}

\EnglishKeywords{relational database, ER diagram, relational schema, CASE tool}

\AddAcronym{SQL}{Structured Query Language}
\AddAcronym{DDL}{Data Definition Language}
\AddAcronym{CASE}{Computer-Aided Software Engineering}
\AddAcronym{ERD}{Entity-Relationship Diagram}
\AddAcronym{DBMS}{Database Management System}
\AddAcronym{DSD}{Data Structure Diagram}
\AddAcronym{EER}{Enhanced Entity–Relationship Model}
\AddAcronym{IDEF}{Integration Definition for Information Modeling}
\AddAcronym{ICAM}{Integrated Computer-Aided Manufacturing}
\AddAcronym{JSON}{JavaScript Object Notation}
\AddAcronym{XML}{Extensible Markup Language}
\AddAcronym{CSV}{Comma-Separated Values}
\AddAcronym{PDF}{Portable Document Format}
\AddAcronym{PNG}{Portable Network Graphics}
\AddAcronym{JDBC}{Java Database Connectivity}
\AddAcronym{JPEG}{Joint Photographic Experts Group}
\AddAcronym{GUI}{Graphical User Interface}
\AddAcronym{WPF}{Windows Presentation Foundation}
\AddAcronym{MVVM}{Model-View-ViewModel}
\AddAcronym{MVC}{Model-View-Controller}
\AddAcronym{XAML}{Extensible Application Markup Language}


\begin{document}

\MakeTitlePages

% Pokud mame v zaverecne praci vypisy kodu, jinak odstranit.
\lstlistoflistings

\section{Úvod}
Strukturované uložení dat je dnes jednou ze základních potřeb většiny vyvíjených aplikací. S rostoucím množstvím uchovávaných dat a potřebou jejich analýzy už dávno není dostačující prosté uložení do souboru. Na tyto potřeby reagují, dnes ve velké míře používané, relační databáze. Před samotným uložením dat je nutné definovat jejich strukturu, konkrétně relační model. Dnešní svět se velmi rychle vyvíjí, tedy mění, a tyto změny často vyvolají potřebu upravit datový model tak, aby co nejlépe reflektoval modelovanou realitu. Právě pro tuto činnost jsou dnes stále častěji používané CASE~nástroje, které umožňují, nejen, snadnou změnu datového modelu prostřednictvím grafického uživatelského rozhraní bez nutnosti psaní vlastních DDL skriptů.

Vyvíjená aplikace slouží pro návrh a aktualizace schématu relační databáze, konkrétně podporuje DBMS Microsoft SQL~Server a Oracle~Database, z toho důvodu je první kapitola věnována popisu notace ER diagramu, který se používá pro vizualizaci vztahů mezi entitami v relačním schématu nejčastěji. Další kapitola se zaměřuje na srovnání možností již existujících nástrojů pro tvorbu ER diagramu. V následující kapitole je popsán návrh a implementace grafického editoru ER diagramu, včetně algoritmů pro vyhledávání cest při vizualizaci vztahů a porovnání jejich výkonosti. Poslední kapitola se zabývá synchronizací mezi ER diagramem a relačním schématem, zejména spoluprací použitých návrhových vzorů pro dosažení požadované funkcionality pro oba, dříve zmíněné, systémy řízení báze dat.

% Zdroje:
\section{Popis notace ER diagramu}
V kontextu relačních databázi jsou ER diagramy nejběžnějším způsobem vizualizace entit vyskytujících se v databázi a jejich vzájemných vztahů. V průběhu let vznikla celá řada notací, které se liší nejen použitými grafickými symboly pro znázornění jak entit, tak kardinality a povinnosti vztahů, ale i dalšími vlastnostmi.

Dodnes nepředstavuje žádná z notací standard v oblasti modelování databází, což je nejvíce patrné na celé řadě CASE nástrojů, které používají mnohdy svou vlastní notaci či dokonce kombinaci symbolů z několika různých notací.

	\subsection{Historie}
	Za předchůdce ER diagramu jsou považovány diagramy datových struktur (DSD) \cite{bachmanDsd}, které rovněž slouží k zachycení entit, vztahů mezi nimi včetně vztažených omezení. Cílem DSD je graficky znázornit dekompozici složitých entit na jednotlivé elementy, k zachycení struktury dat se předpokládalo použití tzv. datových slovníků, které se dají zjednodušeně popsat jako množiny tabulek obsahující metadata, z tohoto principu vychází i systémové katalogy moderních DBMS.
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.75\textwidth]{Figures/BachmanDiagram}
		\caption[Bachmanův diagram]{Bachmanův diagram \cite{wikiDsd}}
	\end{figure}
	
	Speciálním typem DSD je Bachmanův diagram, který slouží k vytvoření relačního datového modelu bez ohledu na způsob fyzického uložení dat v systému. Tento diagram měl patrně největší vliv na pozdější vznik ER diagramu, který publikoval Peter Chen roku 1976 \cite{chenERD}.
	
	Největším rozdílem mezi DSD a ERD, opomineme-li grafickou podobu, je fakt, že DSD se zaměřuje na vztahy mezi jednotlivými elementy entit, zatímco ERD řeší vztahy mezi samotnými entitami.
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.80\textwidth]{Figures/ChenVsDSD}
		\subfloat[Data structure diagram]{\hspace{.5\linewidth}}
		\subfloat[ER diagram]{\hspace{.25\linewidth}}
		\caption[Srovnání DSD a ERD]{Srovnání DSD a ERD \cite{chenERD}}
	\end{figure}
	
	\subsection{Využití ER diagramu}
	Nejčastější použití ER diagramu představuje tvorba nových relačních schémat při návrhu databází, ale rozhodně se nejedná o jedinou oblast využití. Tvorba ER diagramu velmi často stojí na počátku vývoje mnoha informačních systému, protože relační databáze jsou obvykle primárním datovým zdrojem těchto systému pro uložení dat transakčního charakteru. 
	
	ER diagramy umožňují zachytit vztahy a omezení entit v problémové doméně, proto jsou používány nejen při návrhu datové vrstvy, ale i v dalších fázích softwarového procesu. Doménový model aplikace je často ovlivněn právě ER diagramem relační databáze, protože na základě jejich odlišností jsme schopni odhadnout trivialitu objektově-relačního mapování. Trivialita tohoto mapování je často zásadní pro volbu vhodného návrhového vzoru pro implementaci vrstvy přístupu k datovému zdroji. Časté je i využití ER diagramu ve spojitosti s diagramy datových toků, pro znázornění uložení dat business procesu.
	
	Dalším velmi častým použitím ER diagramu je vizualizace již existujících schémat databáze, protože právě grafické znázornění schématu je ideální pro snadné odhalení logických chyb, které mají za následek omezené možnosti aplikace, v některých případech i propady výkonu při náročnějších operacích s daty. 
	Vizualizace existujících schémat nemusí být použitá pouze pro odhalení chyb, ale také při situaci, kdy došlo ke změně některých business procesu. Tyto změny často vyvolají nutnost přizpůsobit relační model změnám, ER diagram je tedy vhodný prostředek nejen k analýze stávajícího schématu pro návrh změn, ale také pro provádění těchto změn použitím CASE nástrojů.
	
	\subsection{Prvky ER diagramu} \label{erDiagramFeatures}
	V této části jsou popsány prvky používané při tvorbě ER diagramu, včetně speciálních případů těchto prvků a příkladů. Ilustrační grafické znázornění odpovídá notaci podle P. Chena, nicméně v další části budou ostatní používané notace dále rozvedeny \cite{erdSymbols}.
	
	\subsubsection{Entitní typ}
	Entitní typy (často označovány v souvislosti s ERD jen jako entity) jsou jednoznačně identifikovatelné objekty vyskytující se v problémové doméně, které jsou pro nás zajímavé svými atributy, daty, které chceme uchovávat např. \textit{zákazník, oddělení, automobil}. Obvykle se označují podstatným jménem v jednotném čísle. 
	
	Rozlišujeme následující typy entit:

	\begin{itemize}
		\item \textbf{Silný entitní typ} - muže existovat nezávisle na ostatních entitních typech, protože obsahuje alespoň jeden atribut, který entitu jednoznačně odlišuje od ostatních, značí se obdélníkem
		
		\item \textbf{Slabý entitní typ} - jeho existence je závislá na jiném entitním typu, protože neobsahuje atribut umožňující jednoznačnou identifikaci, značí se obdélníkem s dvojitým okrajem
		
		\item \textbf{Asociativní entitní typ} - slouží k vyznačení vztahu mezi entitami, obsahuje atributy identifikující tento vztah, značí se kosočtvercem v obdélníku
	\end{itemize}

	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.65\textwidth]{Figures/ChenEntities}
		\caption[Znázornění entit podle Chenovy notace]{Znázornění entit podle Chenovy notace \cite{erdSymbols}}
	\end{figure}

	\subsubsection{Vztah}
	Vztah slouží k vyjádření asociace mezi entitními typy, obecně vyjadřuje informace, které nelze vyjádřit pouhými entitními typy, např. student \textit{studuje} předmět, novinář \textit{napsal} článek. Označuje se slovesem. Znázorňuje se kosočtvercem. 
	
	Identifikující vztah je speciální typ vztahu, který spojuje slabou entitu s entitou, na které je závislá, ta se označuje jako vlastník. Značí se kosočtvercem s dvojitým okrajem.
	
	Vztahy dělíme podle počtu entit, které se v nich vyskytují na vztahy:
	
	\begin{itemize}
		\item \textbf{Unární} - ve vztahu vystupuje pouze jedna entita, ta je ve vztahu sama se sebou, např. zaměstnanec \textit{je nadřízeným} jiného zaměstnance
		\item \textbf{Binární} - vztah mezi dvěma entitami, např. zaměstnanec \textit{je vedoucím} oddělení
		\item \textbf{Ternární} - vztah mezi třemi entitami najednou, např. učitel \textit{doporučuje} knihu třídě
		\item \textbf{N-ární} - vztah mezi \textit{n} entitami zároveň
	\end{itemize}
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.65\textwidth]{Figures/TernaryRelationship2}
		\caption{Příklad ternárního vztahu}
	\end{figure}

	Obecně se ternární vztahy vyskytují v ER diagramech velmi málo, protože vedou k problémům s dekompozicí na několik binárních vztahů při přechodu z konceptuálního modelu na relační (logický), kdy může dojít ke ztrátě některých informací.
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.55\textwidth]{Figures/ChenRelationships}
		\caption[Znázornění vztahů podle Chenovy notace]{Znázornění vztahů podle Chenovy notace \cite{erdSymbols}}
	\end{figure}

	Vztahy dále dělíme podle kardinality, která udává, kolikrát může instance entitního typu být ve vztahu s instancí jiného entitního typu, pro binární typ vztahu  rozlišujeme následující typy kardinality:
	
	\begin{itemize}
		\item \textbf{1:1}
		\item \textbf{1:N}
		\item \textbf{M:N}
	\end{itemize}

	Pro ternární typ vztahu rozlišujeme kardinalitu 1:1:1, 1:1:N, 1:N:M, a M:N:P, pro n-ární typy vztahu se typy kardinality odvozují analogicky.
	
	Poslední důležitou vlastnosti vztahu je povinnost, určující zda může instance entitního typu existovat bez vztahu k jiné instanci entitního typu. Rozlišujeme povinné a nepovinné vztahy.
	
	\subsubsection{Atribut}
	Atributy jsou vlastnosti charakterizující entitní typ. Označují se podstatným jménem, znázorňují se elipsou.
	
	Rozlišujeme následující kategorie atributů:
	
	\begin{itemize}
		\item \textbf{Jednoduchý} - atomický atribut, nelze dále dělit, např. \textit{značka automobilu}
		\item \textbf{Složený} - dělí se na více atomických atributů, např. \textit{adresa} se dělí na \textit{město, ulici a PSČ} 
		\item \textbf{Odvozený} - hodnota je vypočtena na základě hodnot ostatních atributů, fyzicky nemusí v relační databázi existovat, znázorněn je elipsou s čárkovanou hranou, např. \textit{průměrná mzda}
	\end{itemize}

	Další rozdělení je podle počtu hodnot atributu na:
	
	\begin{itemize}
		\item \textbf{Jednohodnotové} - atribut obsahuje pouze jednu hodnotu, např. \textit{rodné číslo}
		\item \textbf{Vícehodnotové} - atribut může obsahovat více hodnot, značí se elipsou s dvojitým okrajem,např. \textit{telefonní číslo na pevnou linku i mobilní telefon}
	\end{itemize}
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.65\textwidth]{Figures/ChenAttr}
		\caption[Znázornění atributů podle Chenovy notace]{Znázornění atributů podle Chenovy notace \cite{erdSymbols}}
	\end{figure}
	
	Označení atributů lze kombinovat, např. \textit{jednohodnotový odvozený atribut}
	
	\subsection{Kategorie modelů}
	Podle úrovně abstrakce rozlišujeme tři typy datových modelů \cite{whatIsERD}, které využíváme při návrhu databázového schématu. Nejvyšší úroveň abstrakce nabízí konceptuální model, který zachycuje pouze entity a vztahy mezi nimi, je nejméně detailní. Více detailů nabízí logický model, poskytuje nižší úroveň abstrakce, ale stále je nezávislý na použitém DMBS. Posledním typem je fyzický model, ten vychází z logického modelu, nicméně se může v mnoha ohledech lišit, protože jeho cílem je obsáhnout dostatečný počet technických detailů pro implementaci databáze. Rozdíly mezi logickým a fyzickým modelem způsobuje fakt, že fyzický model je vytvářen s ohledem na konkrétní použitou technologii, proto i v případě, že zvolíme relační databázi, se mohou pro různé DMBS fyzické modely více či méně lišit. Přehledné shrnutí rozdílů mezi modely nabízí tabulka \ref{tab:modelTypes}.
	
	\begin{table}[!h]
		\centering
		\caption{Rozdíly mezi modely}
		\label{tab:modelTypes}
		\begin{tabular}{l c c c}
			\toprule
			Modelované vlastnosti & Konceptuální & Logický & Fyzický \\
			\midrule
			Názvy entit & \cmark & \cmark & \xmark \\
			Vztahy & \cmark& \cmark & \xmark \\
			Atributy & \cmark& \cmark & \xmark \\
			Primární klíče & \xmark & \cmark & \cmark \\
			Cizí klíče & \xmark & \cmark & \cmark \\
			Názvy tabulek & \xmark & \xmark & \cmark \\
			Názvy sloupců & \xmark & \xmark & \cmark \\
			Datové typy sloupců & \xmark & \xmark & \cmark \\
			\midrule
		\end{tabular}
	\end{table}
	
	
	\subsection{Vývoj notací}
	Stejně jako se vyvíjely potřeby návrhu datových modelů, vznikaly i nové notace ER diagramu. Cílem nově vznikající notací, zejména v průběhu 80tých let, bylo odstranění některých problémů již existujících notací. 
	
	Zásadním mezníkem pro vývoj notací byl objektově orientovaný přístup k vývoji softwaru, na který se mnohé notace snažily reagovat. Tento trend způsobil rozšíření notací ER modelu o koncept generalizace/specializace a dědičnosti, tento typ modelu se označuje jako  Enhanced entity–relationship model (EER). Vlivem popularity objektově-relačních databází vznikly i notace umožňující v modelu zahrnout metody a operace entit. Tento přístup je dnes k vidění v celé řadě CASE nástrojů a  vhodný je zejména pro modelování komplexních databází pro geografické informační systémy nebo telekomunikace.
	
	\subsection{Rozdíly notací}
	Na první pohled mohou různé notace vyvolávat dojem, že nejvýraznějším rozdílem mezi nimi je grafické znázornění entit a vztahů, nicméně rozdílů je mnohem více a některé mohou mít vliv na výslednou podobu fyzického modelu databáze.
	
	\subsubsection{Binární a n-ární modely}
	Nejzásadnějším rozdílem mezi notacemi je podpora n-árních modelů, z toho důvodů rozlišujeme dva typy modelů a to, binární a n-ární \cite{compErNotations}. Pro kategorii binárních modelů je typické, že každý objekt, který má alespoň jeden atribut, je považován za entitu. Není tedy možné přiřadit atribut vztahu, jak je možné běžně vidět u Chenovy notace. Tento fakt je nejvíce patrný u vztahu M:N, kterému chceme přiřadit atribut, pro zaznamenání dalších informací. Přidání neklíčového atributu způsobí nutnost přidat do modelu asociační entitu pro tento vztah. 
	
	V případě n-árních modelů není nutné vytvářet další entity k přidání atributů pro vztah. N-ární vztahy jsou z hlediska sémantiky výhodné pro modelování některých situací oproti vyjádření pomocí několika binárních vztahů. Při přechodu na modely nabízející nižší úroveň abstrakce, je často nutné tyto n-ární vztahy převést na sekvenci binárních vztahů, což může vést ke ztrátě cenný informací, protože už i pro ternární vztah M:N:P může způsobu dekompozice na binární vztahy existovat více a na první pohled nemusí být patrná ztráta části informace, kterou původní vztah nabízel. Tento problém může vést k logickým chybám při návrhu, které mohou mít později za následek velké množství změn v relačním schématu.
	
	Podpora n-árních vztahů vede k nekompatibilitě mezi jednotlivými notacemi, kdy nemusí být snadné převést model používající jednu notaci na notaci jinou. Z tohoto důvodu dnešní CASE nástroje obvykle podporuji pouze jeden typ notace, případně typů podporují více, ale pouze ze stejné kategorie s ohledem na podporu arity vztahů. 
	
	\subsubsection{Kardinalita a povinnost}
	Vyjádření kardinality a povinnosti vztahu je další z mnoha odlišností notací ER diagramu. Pro vyjádření kardinality se používá buď grafické znázornění, nebo označení číslem na obou stranách vztahů v případě starších notací, např. Chenova \cite{dbVsb}. 
	
	Povinnost bývá vyjádřena nejčastěji graficky, buď stylem čáry nebo určitým symbolem na stranách vztahu. 
	
	Speciálním vyjádřením je dvojice (min, max), která vyjadřuje jak kardinalitu, tak povinnost. Tento způsob je použit např. u Min-Max notace, která podle tohoto způsobu převzala i název. 
	
	Jednotlivé notace se neliší vyjádřením kardinality a povinnosti pouze graficky, případně textově, ale také tím, na které straně je informace vyjádřena. Rozlišujeme proto dva styly zápisu, první z nich se označuje jako look here, druhý jako look across \cite{compErNotations}. 
	
	Pokud modelujeme situaci, ve které jeden zaměstnanec pracuje v právě jednom oddělení a oddělení může mít několik zaměstnanců, v look across notaci zapíšeme 1 na stranu oddělení a N na stranu zaměstnance. Pro notaci look here tomu bude přesně naopak, tedy 1 zapíšeme na stranu zaměstnance a N na stranu oddělení. To, na které straně je vyjádřena kardinalita a povinnost nemusí být pro notaci jednotné, Chenova notace používá look across přístup pro vyjádření kardinality, ale povinnost vyjadřuje stylem look here, oproti tomu u notace Min-Max se obvykle dodržuje pouze jeden způsob pro kardinalitu i povinnost.
	
	\subsection{Nejčastěji používané notace}
	Jak už bylo zmíněno, notací existuje celá řada. Jednotlivé notace se v mnoha směrech liší, v následující kapitole jsou vybrané notace popsány, včetně příkladu. Příklad modeluje situaci, kdy jeden člověk má právě jedno místo narození a na jednom místě narození se mohlo narodit více lidí.
	
	\subsubsection{Chenova notace}
	Jedná se o notaci představenou poprvé roku 1976 Peterem Chenem a dodnes se jedná o jednu z nejvíce používaných. Tato notace podporuje n-ární vztahy, původní specifikace obsahovala prvky jen pro entity, vztahy, včetně kardinality, a atributy. Později byla rozšířena o rozlišení povinnosti vztahu a koncept generalizace/specializace. Pro povinnost se používá styl look here, pro kardinalitu look across. Grafické znázornění jednotlivých prvků této notace je popsáno v kapitole \ref{erDiagramFeatures}.
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.75\textwidth]{Figures/NotationExChen}
		\caption[Příklad Chenovy notace]{Příklad Chenovy notace \cite{whatIsERD}}
	\end{figure}
	
	\subsubsection{Bachmanova notace}
	Tento typ notace podporuje nejvýše binární vztahy, vyjádření kardinality používá styl look across, povinnost pak look here, stejně jako je tomu u Chenovy notace. Bachmanova notace modeluje cizí klíče už na konceptuální úrovní, její předpokládané použití je tedy modelování relačních databází. Entity jsou znázorněny obdélníky, vztahy čárami. Vztahům není možné přiřadit atributy, pokud potřebujeme u vztahu M:N přidat neklíčový atribut, je nutná dekompozice pomocí asociační entity. Povinnost vztahu vyjadřuje kruh bez výplně, pro nepovinné vztahy, povinný vztah je naopak vyjádřen plným černým kruhem. Povinnost je vyjádřena vždy na konci vztahu. Pokud čára končí šipkou, jedná se o kardinalitu N, 1 se značí pouhou čárou bez symbolu.
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.75\textwidth]{Figures/NotationExBachman}
		\caption[Příklad Bachmanovy notace]{Příklad Bachmanovy notace \cite{whatIsERD}}
	\end{figure}
	
	\subsubsection{Crow's foot notace}
	Tato notace se označuje také jako Information engineering nebo Martinova notace. Opět podporuje nejvýše binární vztahy, které jsou znázorněny čárami. Není možné vztahu přiřazovat atributy bez asociační entity. Kardinalita i povinnost vztahu používá look across styl a obojí je znázorněno graficky. Entity jsou znázorněny obdélníky, do nich jsou, kromě samotného názvu, vepsány také všechny atributy. Zajímavé je, že ačkoli každá notace používá své grafické symboly, tak znaky pro znázornění kardinality a povinnosti použité touto notací najdeme velmi často v kombinaci s jinými notacemi, jako je např. IDEF1X, detailní popis nalezneme v kapitole \ref{idef1x}. Tato notace je populární zejména v oblasti CASE nástrojů a nalezneme ji v mnohých z nich.
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.75\textwidth]{Figures/NotationExCrow}
		\caption[Příklad Crow's foot notace]{Příklad Crow's foot notace \cite{whatIsERD}}
	\end{figure}
	
	\subsubsection{Barkerova notace}
	Barkerova notace je velmi populární v oblasti tvorby datových modelů pro Oracle Database, vznikla roku 1981 a po příchodu Richarda Barkera do Oraclu, se stala v této oblasti velmi populární. Jedná se o notaci podporující nejvýše binární vztahy, které jsou vyjádřeny čárami. Plná čára symbolizuje povinný vztah, čárkovaná pak vztah nepovinný. Pro vyjádření kardinality je zde použít také symbol vraní nohy. Povinnost používá styl look here, kardinalita pak styl look across. Atributy jsou zde trojího typu, každý typ označuje kategorii atributu. 
	
	Notace používá tyto znaky pro kategorizaci atributů:
	
	\begin{itemize}
		\item \textbf{\#} - identifikující atribut
		\item \textbf{\textasteriskcentered} - povinný atribut
		\item \textbf{$\circ$} - nepovinný atribut
	\end{itemize}

	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.75\textwidth]{Figures/NotationExBarker}
		\caption[Příklad Barkerovy notace]{Příklad Barkerovy notace \cite{whatIsERD}}
	\end{figure}

	Oproti ostatním notacím zde nalezneme určitá specifika. Prvním z nich je tzv. UID čára, obr. \ref{fig:barkerUid}, která se kreslí pouze u slabých entitních typů a vyjadřuje, že je identifikován atributy silných entitních typů. 
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.65\textwidth]{Figures/BarkerUid}
		\caption[Specifika Barkerovy notace - UID]{Specifika Barkerovy notace - UID}
		\label{fig:barkerUid}
	\end{figure}
	
	Dalším specifikem, je možnost vyznačit nepřenositelný vztah, obr. \ref{fig:barkerNonTransferable}, pokud jej použijeme, už jej nelze později změnit, příkladem je vztah mezi kapitolou a knihou, kdy kapitolu z jedné knihy nemůžeme přiřadit knize druhé. Graficky se tento typ vztahu značí přidáním kosočtverce k vraní noze.
	
	\begin{figure}[!h]
		\centering
		\subfloat[Nepřenositelný vztah]
		{
			\includegraphics[width=0.2\textwidth]{Figures/BarkerNonTrans}
			\label{fig:barkerNonTransferable}
		}
		\qquad
		\subfloat[Podtypy]
		{
			\includegraphics[width=0.2\textwidth]{Figures/BarkerSubtypes}
			\label{fig:barkerSubtypes}
		}
		\caption[Specifika Barkerovy notace]{Specifika Barkerovy notace}
	\end{figure}

	Notace podporuje také dědičnost, kdy podtypy dědí atributy supertypu, obr. \ref{fig:barkerSubtypes}, graficky je tento jev vyjádřen přidání obdélníků jednotlivých podtypů do společného obdélníku odpovídajícímu supertypu.
	
	\subsubsection{Min-Max notace}
	Jedná se o notaci, která podporuje nejvýše binární vztahy. Pro vyjádření kardinality a povinnosti vztahu, zde není použit žádný grafický symbol, ale uspořádaná dvojice $(min, max)$, kde minimální počet instancí entitního typu, které musí ve vztahu participovat, určuje povinnost, maximální počet určuje kardinalitu. Styl pro kardinalitu a povinnost se používá jednotný, zpravidla look here.
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.75\textwidth]{Figures/NotationExMinMax}
		\caption[Příklad Min-Max notace]{Příklad Min-Max notace \cite{whatIsERD}}
	\end{figure}
	
	\subsubsection{IDEF1X notace} \label{idef1x}
	IDEF1X je notace, která vnikla v rámci programu ICAM, financovaném US Air Force, jako součást IDEF technik pro modelování informačních systémů. Vztahy jsou podporované nejvýše binární a neklíčové atributy vztahu je nutné modelovat použitím asociační entity. Kardinalita a povinnost vztahu je vyjádřena pomocí $(min, max)$ notace, buď graficky, nebo textově, a nejčastěji používá styl look across. Tato notace rozlišuje graficky silné entitní typy, značí se obdélníkem, a slabé entitní typy, značí se obdélníkem se zakulacenými rohy. Podobně jako u Barkerovy notace je zde možné vyznačit identifikující vztahy. Navzdory tomu, že notace nabízí vlastní grafické symboly pro znázornění kardinality a povinnosti vztahu, je často použita pro tento účel Crow's foot notace, zbytek prvků IDEF1X je ponechán.
	
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.75\textwidth]{Figures/NotationExIDEF1X}
		\caption[Příklad IDEF1X notace]{Příklad IDEF1X notace \cite{whatIsERD}}
	\end{figure}
	
	\subsection{Nevýhody ER diagramů}
	ER diagramy jsou určeny primárně pro vytváření modelů relačních struktur. Pokud pracujeme s nestrukturovanými daty, které není jednoduše možné reprezentovat relacemi, není ER diagram vhodný nástroj k vizualizaci jejich struktury. Toto omezení platí i pro částečně strukturovaná data, nejznámějšími zástupci jsou XML nebo JSON, protože navzdory tomu, že jsme schopni rozlišit jednotlivé entity, může dojít k situaci, kdy entity téhož typu se liší svými atributy. 
	
	\subsection{Shrnutí}
	Každá notace má své klady i zápory, nelze tedy říci, že je některá notace je lepší než jiná, volba notace by měla vycházet z potřeb pro tvorbu konkrétního modelu. Největší rozdíl mezi notacemi představuje možnost modelování ternárních vztahů, případně i vztahů s vyšší aritou. Proto je nutné zvážit zda sémantické možnosti binárních notací jsou pro vytvářený model dostatečné. 
	
	Znázornění kardinality a povinnosti se u jednotlivých notacích liší spíše graficky a všechny zmíněné notace poskytují v této oblasti takřka identické možnosti. Mezi poslední parametry, které mohou volbu notace ovlivnit, řadíme možnost modelování cizích klíčů na konceptuální úrovni, dojde sice k snížení úrovně abstrakce, nicméně konverze na fyzický model je poté jednodušší. Posledním kritériem je možnost modelování subtypů a nepřenositelných vztahů. Toto kritérium, ale nabídku notací velmi omezí. 
	
	Přehledné srovnání vybraných notací nabízí tabulka \ref{tab:notationCmp}.
	
	\begin{table}[h!]
		\centering
		\caption{Srovnání vybraných notací}
		\label{tab:notationCmp}
		\begin{tabular}{l c c c c c c}
			\toprule
			Vlastnost & Chen & Bachman & Crow's foot & Berker & Min-Max & IDEF1X \\
			\midrule
			Ternární vztahy & \cmark & \xmark & \xmark & \xmark & \xmark & \xmark \\
			Look-across kardinalita & \cmark & \cmark & \cmark & \cmark & \xmark & \cmark \\
			Look-across povinnost & \xmark & \xmark & \cmark & \xmark & \xmark & \cmark \\
			(Min, Max) notace vztahů & \xmark & \xmark & \cmark & \xmark & \cmark & \cmark \\
			Neklíčové atributy vztahů & \cmark & \xmark & \xmark & \xmark & \xmark & \xmark \\
			Cizí klíče na koncept. úrovni & \xmark & \cmark & \xmark & \xmark & \xmark & \cmark \\
			Podtypy & \cmark & \cmark & \cmark & \cmark & \cmark & \xmark \\
			\midrule
		\end{tabular}
	\end{table}

\newpage
\section{Popis a srovnání stávajících CASE nástrojů pro modelování relačních databází}
V dnešní době je využití CASE nástrojů v mnoha fázích softwarovém procesu de~facto standardem. Jinak tomu samozřejmě není ani u návrhu datových modelů. Na trhu nalezneme celou řadu nástrojů, od komerčního softwaru po open-source projekty, podporujících tvorbu ER diagramů. 

Tyto nástroje z pravidla nenabízí pouze grafický editor pro vytváření těchto diagramů pro programovou dokumentaci, ale obsahují řadu dalších užitečných funkcí, jako je např. generování patřičných DDL skriptů na základě vytvořeného diagramu.

	\subsection{Výhody a nevýhody CASE nástrojů pro modelování relačních databází}
	Jednou z největších výhod je urychlení vývoje rozsáhlých projektů, protože spousta činností lze použitím CASE nástrojů automatizovat. Mnoho z nich se nezastavuje u pouhého generování skriptů pro nasazení nové databáze, ale využívá reverzního inženýrství k vygenerování ER diagramu z existující databáze nebo na základě DDL skriptu. Stejně tak lze některé nástroje využít k tvorbě objektově-relačního mapování pro přístup k datovému zdroji, což ušetří mnoho času a práce. Tyto možnosti obvykle vedou ke značnému zvýšení produktivity.
	
	Použití CASE nástrojů s sebou nenese jen samá pozitiva, ale skýtá i řadu nedostatků. Největším problémem je obvykle nulová podpora pro provedení formální analýzy vytvořeného modelu, nástroje tedy plně spoléhají na odborné znalosti uživatele. 
	
	Dalším problémem je časová investice nutná k naučení se efektivně pracovat s daným nástrojem, tento problém se netýká pouze modelování relačních databází, ale projevuje se u většiny specializovaných nástrojů. 
	
	Za poslední nevýhodu považuji cenu komerčních nástrojů, protože zejména u menších projektů nemusí být využity veškeré možnosti, které daný produkt nabízí a týmové licence mohou být velmi drahé. Řešením je použití open-source nástrojů, případně tzv. community verze některého z nástrojů, pokud to licenční politika dovolí.
	
	% TODO: Dát screeny do priloh
	\subsection{Srovnání stávajících nástrojů}
	Cílem práce je vytvoření CASE nástroje, který podporuje Oracle Database a Microsoft SQL Server, právě podpora DBMS se stala primárním požadavkem při volbě porovnávaných nástrojů. Každý z následujících nástrojů tedy podporuje alespoň jeden z dvojice dříve zmíněných databázových systémů. Nástroje jsou porovnány na základě mnoha kritérií, mezi jinými např. schopnost reverzního generování ER diagramů nebo způsob synchronizace se stávajícím schématem databáze. Každý z následujících nástrojů nabízí alespoň trial verzi pro otestování jeho funkcionality, v ideálním případě je možné pořídit zdarma licenci pro studenty nebo využít bezplatné community edice. 
	
		\subsubsection{Oracle SQL Developer Data Modeler}
		Autorem prvního nástroje je firma Oracle, která jej vyvíjí od roku 2008. Data Modeler je šířen bezplatně a nainstalovat jej můžeme buď samostatně nebo v rámci nástroje SQL Developer, ovšem ten je zaměřen na správu existujících Oracle databázi, takže možnosti modelování jsou oproti samostatné instalaci Data Modeleru mírně limitovány.
		
		Data Modeler nabízí tvorbu modelů na dvou úrovních abstrakce, prvním je logický model a druhým relační, fyzický, model. Výhodou je možnost vygenerování několika oddělených relačních modelů z jediného logického, pro vizualizaci možných schémat před samotným nasazením. 
		
		V nabídce je trojice notací pro logický model, implicitně je použita Barkerova notace, která je v oblasti Oracle databází nejpoužívanější, nicméně ji lze přepnout na Bachmanovu nebo Information engineering. Oproti jiným nástrojům tuto možnost volby oceňuji, protože si každý uživatel může notaci nastavit podle svých preferencí. Pro relační model už možnost volby neexistuje a je použita mírně modifikovaná Barkerova notace.
		
		Diagramy je možné exportovat ve formátu PDF, případně ve formě PNG nebo JPEG obrázku. Pro samotný relační model je možností exportu hned několik. Pokud nechceme použít nativní formát Data Modeleru, můžeme exportovat do CSV, v tomto případě vznikne hned několik CSV souborů, rozdělených podle jednotlivých prvků diagramu. Dalšími možnostmi je XMLA nebo Cube View Metadata, používané v kombinaci s DB2. 
		
		Nástroj podporuje vygenerování DDL skriptu na základě relačního modelu. Před exportem je nutné nastavit požadované DBMS, v nabídce je Oracle Database, Microsoft SQL Server a IBM DB2, všechny zmíněné jsou podporovány v několika verzích z důvodu překlenutí specifik jednotlivých verzí. Exportování DDL skriptu je doprovázeno kontrolou chyb, ať už se jedná o varování nebo errory, což napomáhá k odhalení problémů ještě před samotným spuštěním skriptu.
		
		Možností importu je opět několik, importovat lze nejen z CSV, Data Cube metadat, XMLA nebo nativního formátu Data Modeleru, ale také na základě DDL skriptu. Tato možnost je výhodná v případě vizualizace již existujících schémat. Ovšem za nejvíce praktickou považuji možnost importu pomoci data dictionary, které umožňuje připojení k existující databázi přes JDBC. Tento způsob importu je možné využít nejen pro Oracle, ale také pro Microsoft SQL Server a IBM DB2.
		
		Po importu a reverzním vytvoření diagramu nástroj umožňuje rovněž aktualizaci schématu databáze na základě změn v ER diagramu, změny se neprovádějí ihned po provedení, ale je nutné synchronizaci spustit ručně. Tento způsob implementace umožňuje nepotvrzené změny jednoduše vrátit zpátky synchronizací diagramu s aktuálním schématem databáze.
		
		Grafický editor reaguje při manipulaci s objekty poměrně rychle, nicméně při přesunu entity nepříjemně blikají, stejně tak korekce čar, po dokončení manipulace s entitou, způsobuje problémy. Konce čar se přemísťují aniž by k tomu byl zjevný důvod, entita byla posunuta jen o několik pixelů, případně jsou vlivem otočení špatně rozlišitelné symboly pro znázornění kardinality.
		
		V průběhu používání jsem se setkal s několika problémy, nejčastěji souvisely s grafickým editorem diagramů. Nepříjemná je drag and drop funkcionalita pro přidání existujících tabulek do diagramu, místo kde tabulku umístíme přetažením je ignorováno a Data Modeler ji umístí obvykle jinde, po přetažení se navíc otevře detail struktury tabulky což je nepříjemné zejména pokud máme v úmyslu přidat více tabulek. 
		
		Nejzávažnější problém se vyskytl při převádění logického modelu na relační, kdy vztahy kardinality M:N byly převedeny chybně, sice došlo k vytvoření asociační tabulky, ale bohužel přibyly atributy cizích klíčů také v obou tabulkách. 
		V logickém modelu je tedy nutné nejprve vytvořit ručně asociační entitu, byť neobsahuje žádné neklíčové atributy a vztah převést na dvojici vztahů 1:N. Po tomto opatření již proběhne převod správně. 
		
		Nepříjemná je také nutnost vytvoření nového relačního schématu ještě před forward engineeringem, protože jinak je vygenerováno relační schéma opakovaně do stejného diagramu a veškeré prvky se vyskytuji duplicitně, v této situaci nezbývá nic jiného než smazat veškerý obsah diagramu a vygenerovat jej znova, protože příkaz \textit{undo} tento problém neřeší.
		
		\subsubsection{Toad Data Modeler}
		Další nástroj je vyvíjen od roku 2006 firmou Quest Software, jedná se o komerční produkt určený pro operační systém Microsoft Windows. Toad podporuje více než 10 různých DBMS v několika verzích, mezi nimi např. Oracle Database, Microsoft SQL Server nebo PostgreSQL.
		
		Toad umožňuje vytvořit 3 typy modelů, nejpoužívanější je fyzický model, který je cílen na konkrétní DBMS, další možností je logický model, ten se ovšem doporučuje jen v případě využití dědičnosti. Posledním typem je univerzální model, který umožňuje tvorbu diagramu bez návaznosti na konkrétní DBMS, případně pokud určený DBMS není mezi podporovanými. Notace jsou tentokrát v nabídce pouze dvě, implicitně nastavený Information Engineering a volitelná IDEF1X.
		
		Export je možné provést do CSV, podle mého názoru je export řešen lépe než v Data Modeleru, protože CSV soubor je exportován pouze jeden a prvky jsou odděleny vnitřní strukturou souboru. Další možnosti je export do Excelu, který prvky rozděluje do samostatných sešitů. Poslední možností je export ve formě obrázku. Tato volba nabízí mnoho nastavení od velikosti plátna, rozdělení na stránky pro tisk po kompresi a barevnou hloubku.
		
		Z diagramu je možné vygenerovat DDL skript pro všechny podporované DBMS bez ohledu na to, jaký byl zvolen při zakládaní projektu. DDL skripty je možné generovat buď úplné nebo obsahující jen změny v diagramu provedené v případě reverzního vygenerování. Takto vygenerovaný skript neobsahuje pouze tabulky a integritní omezení, ale může zahrnovat i uložené procedury, funkce, triggery nebo indexy. 
		
		Nástroj umožňuje rovněž kontrolu vytvořeného modelu než přejdeme ke generování skriptů. Fyzických modelů umožňuje vytvořit Toad několik v jednom projektu a následně je schopen provést jejich porovnání a přehledně vypsat v čem se liší, modely je možné dokonce i sloučit. Další zajímavou volbou je možnost migrace na jiný DBMS než z jakého byl model importován.
		
		Import modelu je možný nejen z CSV, Excelu a nativního formátu, ale také z jiných aplikací, konkrétně ER/Studio Data Architect a Toad for Oracle. Vytvoření modelu z DDL skriptu bohužel v případě tohoto nástroje chybí. Samozřejmostí je reverzní vygenerování modelu z připojené databáze, do projektu zde lze zahrnout i indexy, procedury a další objekty z databáze, které poté mohou být rovněž součástí DDL skriptu.
		
		Aktualizace databáze na základě změn v ER diagramu je možné provádět buď spuštěním vygenerovaného DDL skriptu obsahující změny samostatně nebo lze využít definovaného připojení a změny provést přes GUI. Toad nabízí uložení modelů v různých fázích úprav, tento přístup umožňuje modely porovnat a případně vygenerovat skript na základě rozdílů mezi nimi.
		
		Velmi užitečnou funkcí je možnost vytváření reportů. Reporty lze generovat do PDF nebo jako statické webové stránky, což je výhodné pro tvorbu dokumentace. Report obsahuje kompletní datový slovník, přehledně vypsané informace o integritních omezeních, zdrojové kódy uložených funkcí, procedur a mnoho dalšího. Před vygenerováním lze nastavit, co vše má být v reportu obsaženo.
		
		Grafický editor pro tvorbu diagramů reaguje velmi rychle a za dobu testování jsem se nesetkal s žádnými výraznými problémy. Zobrazení entit lze měnit od  pouhého názvu po detailní výpis atributů. Vztahům lze přidávat popisky, samozřejmě je lze v případě potřeby vypnout. Pracovní plocha je rozdělena na části, velikosti A4, kvůli rozvržení pro tisk. Nevýhodou je absence mřížky, ke které by šly objekty přichytávat. Vztahy jsou reprezentovány lomenou čárou, úhly jsou vždy pravé což považuji za velké plus z pohledu přehlednosti. Do pracovní plochy lze kromě entit a vztahů vkládat také text a základní geometrické tvary, tato možnost je využitelná pro tvorbu popisků.
		
		Jeden z mála problémů, se kterým jsem se setkal, bylo hromadné přidání všech tabulek a vztahů z existující databáze do diagramu. Tabulky se všechny umístily do jednoho místa a bylo je nutné postupně rozprostřít po větší ploše. Naštěstí výrobce na tento problém pamatoval a v nabídce je volba \textit{autolayout}. Ta ma za následek automatické uspořádání tabulek tak, aby se nepřekrývaly. Rozložení je možné shora dolů, zleva doprava nebo abecedně do obdélníku. Podobně lze znova vykreslit vztahy, dokonce lze i zakázat jejich křížení, vyhledávání tras je velmi rychle a dokonce ani po zapnutí volby pro cp nejpřesnější trasy nepřesáhl čas, dle mého odhadu, sekundu. 
		
		Jediná věc co bych Toad Data Modeleru vytkl je nepřehlednost uživatelského rozhraní. Jedná se o opravdu velmi komplexní nástroj a to mělo na GUI pravděpodobně největší dopad. Hlavní menu obsahuje sice optimální počet položek a není překombinované ani co se týká úrovní zanoření, nicméně o nástrojové liště to říct nelze. Většina funkcionality je směřovaná zde a novému uživateli zabere nějaký čas než prozkoumá veškeré možnosti, výhodou je velké množství klávesových zkratek, které velmi usnadňují práci. Problém způsobovalo také rozvržení spodních panelů na displayi s nižším rozlišením, nicméně přesunutí docků fungovalo bez problémů a na displayi s FullHD rozlišením se problém neprojevil.
		
		\subsubsection{SQL Server Management Studio}
		Tento nástroj, často označován jen jako SSMS, je vyvíjen společnosti Microsoft, první verze byla vydaná společně s Microsoft SQL Server 2005. Jedná se o plnohodnotný nástroj pro administraci SQL Serveru, většina potřebných úkonů je možné provést s využitím GUI. Součástí tohoto nástroje je také možnost tvorby ER diagramů a právě na něj se zaměříme. Nástroj je určen pro platformu Microsoft Windows a kromě SQL Serveru nepodporuje žádné další DBMS.
		
		Management studio umožňuje pouze tvorbu fyzického modelu databáze. Nemožnost tvorby modelů na jiných úrovní abstrakce je způsobena primárním zaměřením celého nástroje na správu již existujících databází. Konceptuální model tedy v tomto případě postrádá smysl. Použitá notace je specifická pro tento nástroj, nepoužívá žádnou z dříve zmíněných notací. Povinnost vztahu je znázorněna graficky v look here stylu, kardinalita znázorněna není, předpokládá se 1:N. 
		
		Import diagramů z jiných nástrojů nebo souboru není k dispozici v žádné formě, jedinou možností je vytvoření databáze na serveru a vygenerování diagramu na základě jejího schématu. Stejně tak není podporován ani export do CSV, Excelu nebo XML jako je tomu u konkurenčních nástrojů. 
		
		Diagramy jsou uloženy ve speciální tabulce přímo v databázi, v práci je tedy možné bez problémů pokračovat z jiného počítače aniž bychom museli kopírovat soubory projektu. Nástroj podporuje tisk diagramů, takto můžeme vytvořit i PDF nebo XPS.
		
		Reverzní generování diagramu umožňuje vizualizovat pouze vybranou část schématu, tato možnost je praktická zejména při práci s rozsáhlými systémy, kde lze schéma rozdělit na logické celky. Aktualizace schématu databáze prostřednictvím ER diagramu jsou velmi rychlé, stačí potvrzení změn uložením diagramu a patřičné změny se ihned promítnou v aktuálním schématu. Před potvrzením je možné zobrazit DDL skript obsahující SQL příkazy k modifikaci schématu. 
		
		Přepínání mezi diagramy funguje prakticky okamžitě, změny provedené v jednom jsou ihned zobrazeny v druhém, z tohoto pohledu je synchronizace na skvělé úrovni. Problém způsobilo jen přidání atributu do tabulky, ze které byl atribut se stejným názvem v dalším diagramu smazán, změny byly potvrzeny opožděně nicméně tato situace skončila chybou a pomohlo jen smazání diagramů z databáze a jejich opětovné vygenerování. Tento fakt nepovažuji za zásadní selhání, protože se jedná o zcela neobvyklou operaci, kterou bych mimo testování prováděl jen těžko.
		
		Vybraná část schématu, která je součásti diagramu bohužel nejde exportovat ve formě DDL skriptu, je možné vytvořit pouze DDL skript pro jednotlivé tabulky a tyto dílčí části zkompletovat v textovém editoru podle potřeby.
		
		Grafický editor reaguje, ve srovnání s ostatními nástroji, nejrychleji z testovaných. Umožňuje přidat kromě objektů z databáze také popisky, stejně tak je možné přidávat popisky vztahům. Režimů zobrazení tabulek editor nabízí také několik, od pouhého názvu tabulky po zobrazení pouze klíčových atributů. V případě potřeby je možné využít autolayout, podobně jako u Toad Modeleru, a celé schéma nechat přehledně uspořádat. 
		
		Žádné problémy s grafickým editorem jako je špatné uspořádání čar, blikání objektů a podobně se nevyskytly. Práce je velmi intuitivní a editor neobsahuje 
		zbytečné funkce. Právě tato jednoduchost má největší vliv na uživatelský komfort, který je podle mě na nejlepší úrovní z testovaných nástrojů.
		
		\subsubsection{Visual Paradigm}
		Dalším testovaným nástrojem je komerční produkt od firmy Visual Paradigm International, zastřešuje ji Hong Kong Institute of Vocational Education, který je určen primárně pro tvorbu UML diagramů. Nástroj samozřejmě podporuje i modelování relačních databází formou ER diagramu. K dispozici je několik typů placených licencí, rozdělených podle nabízených možností a také community edice, která je určena pro nekomerční projekty. Nevýhodou community edice je absence veškerých pokročilých funkcí pro práci s relační databázi jako je např. reverzní generování diagramů..
		
		Visual Paradigm podporuje tvorbu logických modelů bez nutnosti specifikovat DBMS, ten je nutné uvést až při generování skriptu a nástroj podporuje více než deset různých systémů. Diagram používá Crow's foot notaci, bohužel je jediná podporovaná a nelze ji přepnout jako v případě jiných nástrojů.
		
		Diagramy je možné importovat v rámci projektu, samostatný import není možný. Diagramy můžeme importovat z nezávislých formátů jako je XML nebo i z jiných nástrojů, příkladem je konkurenční Enterprise Architect, dále Excel, Visio a několik dalších. 
		
		Nástroj nabízí tisk diagramů, pomocí této volby jsme schopni vytvořit i PDF nebo XPS soubor. Další možností exportu, kromě nativního formátu, je XML soubor a obrázek. Nastavení je poměrně detailní, lze nastavit formát, kompresi a dokonce i rozřezání diagramu na části specifikované svou velikostí. V případě XML můžeme ovlivnit jeho podobu volbou struktury, na výběr máme reprezentaci vlastností objektu samostatnými elementy nebo atributy příslušného elementu.
		
		Nástroj podporuje generování DDL skriptu vytvořeného diagramu. Diagramy mohou obsahovat i uložené procedury, funkce a triggery, které mohou být také součásti  tohoto skriptu. Skript můžeme uložit pouze do souboru nebo jej rovnou spustit nad definovaným připojením a modelované schéma tak fyzicky vytvořit v databázi. Oproti dalších nástrojům umí Visual Paradigm vygenerovat také kostru příkazů pro vložení a aktualizaci záznamů pro jednotlivé tabulky.
		
		Na rozdíl od jiných nástrojů je možné vytvořit z logického modelu také kostru pro objektově-relační mapování. Tuto volbu považuji za jeden z největších přínosů, protože pro rozsáhlé databáze ušetří obrovské množství času. Další užitečnou funkcí je i možnost synchronizace s třídním diagramem.
		
		Diagramy můžeme reverzně generovat z existující databáze nebo DDL skriptu. Synchronizace se schématem databáze není provedena okamžitě, ale je nutné ji spustit prostřednictvím GUI. Definování nového připojení k databázi je bohužel jedna ze slabých stránek nástroje, pro SQL Server jsou možnosti velmi omezené a chybí např. možnost autentikace pomocí Windows účtu. Pro testování jsem tedy musel vytvořit nový login a databázového uživatele. Samotné připojení k databázi se pravděpodobně provádí na hlavním vlákně, to způsobilo v případě pomalé odezvy serveru zamrznutí GUI i na několik sekund.
		
		Práce s grafickým editorem je intuitivní, reakce působí svižně a nedochází k žádným problémům s výskytem grafických artefaktů. Zobrazení tabulek je  možné všemožně upravovat, k dispozici je i mřížka, ke které lze objekty zachytávat. Samozřejmostí je i zobrazení popisků vztahů, případně dalších objektů. Uživatelské rozhání je, vzhledem ke komplexnosti nástroje, přehledně uspořádáno. Nástroj považuj za vhodnou volbu zejména pro rozsáhlejší projekty, kde je výhodné diagram datového modelu využít i v dalších diagramech.
		
		\subsubsection{StarUML 2}
		StarUML je poměrně nový nástroj, první verze byla vydaná roku 2014, který následuje trend desktopových aplikací vytvořených pomocí webových technologií. Tyto aplikace využívají pro svůj běh NodeJS, což umožňuje nasazení bez ohledu na platformu. Jedná se o komerční nástroj, pro testování jsem použil trial verzi, licence pro studenty není zdarma, lze ji ale pořídit se slevou.
		
		Nástroj podporuje pouze logický model, který používá Crow's foot notaci, jiné typy notací bohužel v nabídce nejsou. Model je vytvářen univerzálně, je možné  použití pro různá DBMS. 
		
		Zde se dostáváme k největší výhodě nástroje, kterou je modularita. Použití webových technologií umožňuje velmi snadnou tvorbu doplňků, ty lze instalovat z oficiálního repozitáře, po instalaci dokonce nebyl nutný ani restart aplikace a nové možnosti byly dostupné ihned. Právě doplněk je nutný i pro generování DDL skriptu, protože samotná aplikace tuto možnost neobsahuje. Zmíněný doplněk v současné době podporuje MySQL a Oracle Database, zdrojové kódy jsou dostupné na Githubu, což přináší možnost rozšířit funkcionalitu o další DBMS.
		
		Importovat diagramy lze pouze z nativního formátu souboru a StarUML 1. Výhodou je, že nástroj ukládá diagramy v podobě JSONu, tento formát je možné využít pro případnou interoperabilitu s jinými nástroji.
		
		Export diagramu je možný ve formátu png, jpeg a dokonce svg, což je vhodné pokud potřebujeme diagram využít i v jiném softwaru, který podporuje vektorové formáty, poslední možností je export do pdf. Nástroj umí vytvořit report ve formě webových stránek, zde nalezneme jak diagramy projektu, tak detailní popis tabulek, atributů a vztahů. 
		
		Nástroj bohužel nenabízí možnost reverzního generování diagramů z databáze, ani DDL skriptu. Stejně tak nástroj postrádá synchronizaci s již existujícím schématem. Možným řešením je modul, který by rozšířil nástroj o tuto funkcionalitu, v současné době se mi bohužel nepodařilo takový najít.
		
		Grafický editor nabízí všechny základní funkce pro vytváření ER diagramu a celkově působí uživatelské rozhraní přehledně. Ovšem za největší nedostatek považuji rychlost reakcí editoru. Zde se bohužel projevil nižší výkon použitých technologií oproti klasickému přístupu k vývoji desktopových aplikací. Při přesouvání objektů po plátně se editor velmi znatelně zadrhává, rychlost odezvy při modelování rozsáhlých schémat si raději ani nepředstavuji. Vzhledem ke zbytku srovnávaných nástrojů je v tomto ohledu StarUML rozhodně nejhorší.
	
	\subsection{Shrnutí}
	Všechny testované nástroje nabízí alespoň základní funkcionalitu nutnou pro úspěšné vytvoření ER diagramu. Většina z nich se nezastavuje u pouhého grafického editoru s možností exportu DDL skriptu, ale nabízí mnoho daleko komplexnějších funkcí. Hodnocen nebyl pouze grafický editor pro tvorbu diagramů, ale také možnosti reverzního generování diagramů z databáze a s tím spojená synchronizace s jejím schématem. Dalším aspektem v hodnocení byly také možnosti importu a exportu schémat, kdy XML nebo CSV mohou být výhodné z hlediska strojového zpracování nástroji pro formální analýzu, zatímco export do Excelu nebo PDF je důležitý pro tvorbu dokumentace projektu.
	
	Z hlediska grafického editoru považuji za nejlepší SQL Server Management Studio pro jeho rychlost a snadnou aplikaci změn na existující schéma, jen je škoda, že jej nelze použít i pro jiná DBMS. Stejně kvalitním editorem disponuje např. Visual Paradigm, který je vhodný pro jiné DBMS. Přehledné srovnání možností z pohledu grafických editorů nabízí tabulka \ref{tab:geditCmp}. Rychlost odezvy a přehlednost GUI je hodnocena známkou z intervalu 1--5, stejně jako ve škole.
	
	\begin{table}[h!]
		\centering
		\caption{Srovnání grafických editorů pro vybrané CASE nástroje}
		\label{tab:geditCmp}
		\begin{tabular}{l c c c c c}
			\toprule
			Vlastnost & SQL Dev. & Toad & SSMS & Visual Paradigm & StarUML \\
			\midrule
			Výchozí notace & Barker & IE & Vlastní & Crow's foot & Crow's foot \\
			Možnost volby notace & Ano & Ano & Ne & Ne & Ne \\
			Strojově čitelný export & Ano & Ano & Ne & Ano & Ano \\
			Export do PDS/XPS & Ano & Ano & Ano & Ano & Ano \\
			Export formou obrázku & Ano & Ano & Ne & Ano & Ano \\
			Rychlost odezvy & 3 & 2 & 1 & 1 & 4 \\
			Přehlednost GUI & 2 & 3 & 1 & 2 & 1 \\
			\midrule
		\end{tabular}
	\end{table}
	
	\newpage
	V oblasti synchronizace diagramu s existující databázi je nejlepší Toad Data Modeler. Ostatní nástroje předčil podporou mnoha DBMS, porovnáním modelů a detailními možnostmi nastavení generování DDL skriptu. Srovnání všech nástrojů v této oblasti nalezneme v tabulce \ref{tab:ddlCreateCmp}, komfort aktualizací schématu je opět hodnocen známkami 1--5, StarUML je z tohoto hodnocení vynechán, protože práci s databázi nepodporuje.
	
	\begin{table}[!h]
		\centering
		\caption{Srovnání možností synchronizace pro vybrané CASE nástroje}
		\label{tab:ddlCreateCmp}
		\begin{tabular}{l c c c c c}
			\toprule
			Vlastnost & SQL Dev. & Toad & SSMS & Visual Paradigm & StarUML \\
			\midrule
			Synchronizace s exist. schématem & Ano & Ano & Ano & Ano & Ne \\
			Podpora více DBMS & Ano & Ano & Ne & Ano & Ano \\
			Reverzní generování - databáze & Ano & Ano & Ano & Ano & Ne \\
			Reverzní generování - DDL & Ano & Ano & Ano & Ano & Ne  \\
			Export kompletního DDL & Ano & Ano & Ne & Ano & Ano \\
			Export DDL se změnami & Ano & Ano & Ano & Ano & Ne \\
			Migrace na jiný DBMS & Ano & Ano & Ne & Ano & Ne \\
			Komparace modelů & Ne & Ano & Ne & Ne & Ne \\
			Procedury v modelu & Ne & Ano & Ne & Ano & Ne \\
			Komfort aktualizace schématu & 1 & 2 & 1 & 3 & - \\
			\midrule
		\end{tabular}
	\end{table}
	
\newpage
\section{Návrh a implementace grafického editoru ER diagramů}
Grafický editor představuje jádro celého CASE nástroje, protože většina operací, které nástroj umožňuje, je prováděna prostřednictvím jeho rozhraní. Nástroj je implementován jako desktopová WPF aplikace určena pro operační systém Microsoft Windows. S WPF aplikacemi se váže návrhový vzor MVVM, který slouží k oddělení prezentační vrstvy od doménové logiky, včetně přístupu k zdroji dat. Tento přístup je výhodný zejména pro vývoj rozsáhlejších aplikací, kdy čistě událostmi řízené programování může vést k obtížím s laděním aplikace, případně pozdějším úpravám v oblasti grafického rozhraní.
	
	\subsection{Klíčové části grafického editoru}
	Grafický editor je, stejně jako ostatní části aplikace, navrhnut s ohledem na, výše zmíněný, návrhová vzor MVVM. Viewmodely ve WPF aplikacích slouží pro agregování dat pro jednotlivé komponenty v podobě jaká vyhovuje prezentační vrstvě. Provázaní těchto dat s prezentační vrstvou je řešeno principem, který se obecně označuje jako data-binding. 
	
	Standardně se realizuje toto provázání v XAML kódu, který určuje strukturu uživatelského rozhraní aplikace, nicméně tato praktika se používá zpravidla pro komponenty jako je tabulka nebo seznam, kdy hlavním úkolem je prezentace dat ze zdroje a práce s nimi. Grafický editor je z tohoto pohledu specifickou komponentou, zejména co se týká povahy prováděných operací, provázaní dat s prezentační vrstvou bylo tedy nutné implementovat alternativním způsobem. 
		
		\subsubsection{Provázání editoru s daty}
		Každá komponenta má, pro správnou implementaci vzoru MVVM, vlastní viewmodel, jenž je vlastněn výhradně touto komponentou. Kromě, výše zmíněného, uchovávaní dat slouží viewmodely také ke komunikaci mezi jednotlivými komponentami. 
		
		Stejně je tomu i v případě grafického editoru, viemodel obsahuje trojici kolekcí obsahující viewmodely tabulek, vztahů a popisků, tedy objektů, které se vyskytují na plátně. Kolekce po přidání nebo odebraní objektu vyvolají událost, na kterou patřičným způsobem reaguje komponenta editoru. Viewmodel tedy vystavuje rozhraní grafického editoru ostatním komponentám, kdy pro přidání nové tabulky stačí jen vložit její viewmodel, s nastavenými hodnotami, do kolekce tabulek a editor se sám postará o přidání objektu na plátno, není tedy nutná přímá interakce jiné komponenty s prezentační vrstvou grafického editoru.
		
		Tato implementace umožňuje pracovat s grafickým editorem na úrovni viewmodelu, stejným způsobem jako s komponentami využívajícími standardní způsob data-bindingu ve WPF aplikacích. 
		
		\subsubsection{Přesouvaní a změna rozměrů tabulek v diagramu}
		Implementace obou operací je úzce spjatá s použitím WPF komponenty Thumb, která je nejčastěji využívaná v aplikacích, které pro své fungování využívají výhody dotykového displaye. Na první pohled se jeví jako nejsnazší řešení explicitní zachytávaní událostí vyvolaných po stisku tlačítka a tahu myši s následným výpočtem rozdílu mezi aktuálním a počátečním bodem. Problémem této implementace je obtížná generalizace tohoto řešení, protože zde vzniká závislost na implementaci komponenty pro grafické znázornění tabulky. 
		
		Tuto závislost lze řešit právě použitím, již zmíněné, komponenty Thumb v kombinaci s XAML šablonou. Thumb vyvolává událost na počátku tahu, v jeho průběhu a po ukončení tahu. Explicitní zachytávání událostí myší tedy není nutné, stejně tak rozdíl souřadnic počátečního a aktuálního bodu je součásti argumentu událostí. Šablona umožňuje nastavení společných základních vlastností pro jakoukoli implementaci komponenty pro tabulku, společně s definicí triggeru pro zviditelnění vrstvy umožňující změnu rozměrů tabulky po jejím výběru. Tímto způsobem je možné provádět úpravy komponenty pro zobrazení tabulky aniž by došlo k narušení funkcionality přesunu a změny rozměrů. 
		
		\begin{figure}[!h]
			\centering
			\includegraphics[width=0.75\textwidth]{Figures/EditorTabulky}
			\caption{Část třídního diagramu - přesunutí a změna rozměrů tabulky}
			\label{fig:classDiagResize}
		\end{figure}
		
		Změna rozměrů využívá opět komponenty Thumb, která je nyní součástí tzv. adorner vrstvy, tato vrstva se zobrazí až po vybraní tabulky. Vybraním dojde k úpravě hodnoty jejího z-indexu tak, aby překryla veškeré ostatní objekty na plátně a bylo možné s ní komfortně pracovat. 
		
		Pro zprostředkování komunikace mezi šablonou a viewmodelem tabulky slouží třída TableContent. Tato třída obsahuje referenci na viewmodel tabulky, po interakci s Thumb objekty tedy zajistí aktualizaci patřičných hodnot v jeho vlastnostech. Třída TableContent slouží také k propagaci události pro přidání atributu, odstranění tabulky z databáze a mnohé další, tak aby komponenta pro grafické znázornění tabulky obsahovala co nejméně doménové logiky.
		
		Vztahy mezi zmíněnými třídami zachycuje třídní diagram na obr. \ref{fig:classDiagResize}, ten je značně zjednodušený oproti implementaci, obsahuje jen položky důležité pro tuto část.
		
		\subsubsection{Úpravy čar pro vizualizaci vztahu}
		Práce se samotnými vztahy probíhá opět na úrovní viewmodelu, podobně jako je tomu u tabulek, nicméně samotný vztah nyní není reprezentován jediným objektem na plátně, ale objektů se zde vyskytuje celá řada. Grafický editor používá Oracle CASE notaci, vztah je reprezentován lomenou čárou, na obou koncích této čáry se nachází symboly vyjádřující kardinalitu a povinnost. 
		
		V grafickém editoru je použita vlastní implementace lomené čáry, protože třída Polyline, která je pro práci s lomenými čárami určená, nabízí velmi omezené možnosti interakce ze strany uživatele a hodí se tedy spíše pro pouhou vizualizaci dat např. formou grafu, kde jsou zobrazovaná data aktualizována pomocí jiných prvků uživatelského rozhraní a přímá interakce není nutná.
		
		Viewmodel pro vztah tedy, kromě samotného datového modelu s parametry vztahu, obsahuje kolekci lomových bodů čáry, společně s kolekcí čar, které tvoří jednotlivé segmenty lomené čáry. V první fázi jsou segmenty vytvořeny na základě lomových bodů, které jsou po přidání nového vztahu určeny algoritmem pro vyhledání trasy, detailní popis této činnosti se nachází v kapitole \ref{secAStar}. Editor reaguje na události vyvolané při práci s kolekcí čar tak, aby byla zajištěna integrita dat viewmodelu s objekty na plátně. Závislosti mezi třídami pro zajištění této funkcionality nástroje popisuje třídní diagram \ref{fig:classDiagMovePolyline}.
		
		\begin{figure}[!h]
			\centering
			\includegraphics[width=0.75\textwidth]{Figures/EditorTabulky}
			\caption{Část třídního diagramu - vizualizace vztahu mezi tabulkami}
			\label{fig:classDiagMovePolyline}
		\end{figure}
		
		Všechny segmenty lomené čáry reagují na interakci pomocí myši, pro přenos informací, o provedených změnách, do viewmodelu je využit návrhový vzor Pozorovatel, který využívá pro tuto činnost události. Viewmodel vztahu je informován o průběhu interakce, tím je tedy možné provádět aktualizaci pozice přilehlých segmentů lomené čáry včetně ukončujících symbolů v závislosti na pohybu určitého segmentu. Po ukončení interakce je opět vyvolána událost, která spustí post-processing, jehož součástí je např. spojení stejně orientovaných segmentů čáry lišících se pozicí v rámci tolerance nebo změna orientace ukončujících symbolů na základě orientace krajních segmentů čáry.
		
	
	\subsection{Algoritmy pro automatické rozvržení objektů}
		\subsubsection{Výpočet trasy po přidání vztahu} \label{secAStar}
		\subsubsection{Automatické rozvržení tabulek}
	
	\subsection{Serializace diagramu}
	
	\subsection{Export diagramu}
	
\newpage
\section{Návrh a implementace synchronizace ER diagramů s relačním schématem}

\newpage
\section{Závěr}

\newpage
% TODO: Dopsat zdroje - vždy nad kapitolou
\begin{thebibliography}{99}
	\bibitem{chenERD} CHEN, Peter Pin-Shan. \textit{The entity-relationship model---toward a unified view of data. ACM Transactions on Database Systems} [online]. 1(1), 9-36 [cit. 2017-03-10]. Dostupné z: \url{http://dspace.mit.edu/bitstream/handle/1721.1/47432/entityrelationshx00chen.pdf}
	
	\bibitem{dbVsb} KRÁTKÝ, Michal a Radim BAČA. \textit{Databazové systémy} [online]. [cit. 2017-03-11]. Dostupné z: \url{http://dbedu.cs.vsb.cz/SubPages/OpenFile.aspx?file=book/dbcb.pdf}
	
	\bibitem{compErNotations} SONG, Il-Yeol, Mary EVANS a E.K. PARK. \textit{A Comparative Analysis of Entity-Relationship Diagrams} [online]. [cit. 2017-03-11]. Dostupné z: \url{http://www.cci.drexel.edu/faculty/song/publications/p_Jcse-erd.PDF}
	
	\bibitem{bachmanDsd} BACHMAN, C. W. \textit{Data structure diagrams} [online]. [cit. 2017-03-11]. Dostupné z: \url{http://www.minet.uni-jena.de/dbis/lehre/ws2005/dbs1/Bachman-DataStructureDiagrams.pdf}
	
	\bibitem{wikiDsd} Data structure diagram. In: \textit{Wikipedia: the free encyclopedia} [online]. San Francisco (CA): Wikimedia Foundation, 2001- [cit. 2017-03-11]. Dostupné z: \url{https://en.wikipedia.org/wiki/Data_structure_diagram}
	
	\bibitem{whatIsERD}Lucidchart. \textit{What is an Entity Relationship Diagram} [online]. [cit. 2017-03-10]. Dostupné z: \url{https://www.lucidchart.com/pages/er-diagrams}
	
	\bibitem{erdSymbols}Lucidchart. \textit{ER Diagram Symbols and Notation} [online]. [cit. 2017-03-10]. Dostupné z: \url{https://www.lucidchart.com/pages/ER-diagram-symbols-and-meaning}
\end{thebibliography}


\appendix
% TODO: Linky na knihovny z GitHubu
\section{Použité knihovny třetích stran}
\begin{itemize}
	\item MetroLib
	\item AvalonDock
\end{itemize}

\section{Struktura přiloženého optického média}
\textbf{Složka} Popis

\section{Instalace programu}
Popis instalace.

\end{document}
